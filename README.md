# 图像取色工具 - Image Color Picker

一个基于Python和tkinter的GUI应用程序，用于打开BMP图像文件并提取像素点的颜色信息。

## 功能特性

- ✅ 支持BMP图像文件的打开和预览
- ✅ 图像缩放功能（25% - 400%）
- ✅ 鼠标点击获取像素点6. **DPI自适应**: 在高分辨率显示器上自动调整界面大小
7. **智能重采样**: 根据缩放级别选择最佳图像处理算法
8. **屏幕取色**: 悬浮窗模式支持从任意屏幕位置实时取色
9. **跨应用取色**: 可以从浏览器、办公软件、设计软件等任何应用中取色信息
- ✅ 显示RGB和HSV颜色值
- ✅ 颜色十六进制值显示
- ✅ 实时颜色预览
- ✅ 图像滚动查看
- ✅ 像素坐标显示
- 🆕 **颜色记录功能**：自动记录每次点击的颜色信息
- 🆕 **多格式导出**：支持JSON、CSV、XML、TXT格式导出
- 🆕 **记录管理**：查看记录数量、清空记录功能
- 🆕 **高DPI支持**：自动适应不同分辨率和缩放设置
- 🆕 **智能缩放**：根据缩放比例选择最佳重采样算法
- 🔥 **悬浮窗模式**：实时从屏幕任意位置取色
- 🔥 **全屏取色**：支持从浏览器、应用程序等任何界面取色

## 系统要求

- Python 3.6+
- tkinter（通常随Python一起安装）
- PIL/Pillow 库
- Windows 10/11（推荐，具有完整的高DPI支持）

## 高DPI优化特性

### 自动DPI检测
- 程序会自动检测系统DPI设置
- 根据DPI缩放因子调整界面元素大小
- 支持100%、125%、150%、200%等常见缩放设置

### 智能图像缩放
- **放大(>100%)**：使用NEAREST算法保持像素锐利
- **缩小(<50%)**：使用LANCZOS算法获得最佳质量
- **中等缩放**：使用BILINEAR算法平衡质量和性能

### 界面自适应
- 字体大小根据DPI自动调整
- 按钮和控件大小随缩放因子变化
- 窗口最小尺寸保证可用性

## 安装依赖

```bash
pip install Pillow
```

## 使用方法

1. 运行程序：
   ```bash
   python image_color_picker.py
   ```

2. 点击"选择BMP图像"按钮选择图像文件

3. 使用缩放控件调整图像显示大小

4. 用鼠标点击图像上的任意像素点

5. 在右侧面板查看该像素点的颜色信息：
   - 像素坐标 (X, Y)
   - RGB值 (红, 绿, 蓝)
   - 十六进制颜色值
   - HSV值 (色相, 饱和度, 明度)
   - 颜色预览块

6. **颜色记录管理**：
   - 每次点击都会自动记录颜色信息
   - 查看已记录的颜色数量
   - 点击"清空记录"可清除所有记录
   - 点击"导出记录"可将记录保存为文件

7. **悬浮窗取色模式**：
   - 点击"启动悬浮窗"按钮进入屏幕取色模式
   - 悬浮窗会显示在屏幕右上角，保持置顶
   - 实时显示鼠标位置的颜色信息
   - 点击"取色"按钮或使用Ctrl+点击来记录当前颜色
   - 支持从任何应用程序、浏览器、桌面等位置取色

8. **悬浮窗功能**：
   - 实时显示鼠标坐标
   - 实时显示RGB和十六进制颜色值
   - 颜色预览块
   - 半透明窗口设计，不干扰正常操作
   - 一键取色并自动记录到历史

9. **导出格式选择**：
   - **JSON格式**：适合程序读取，包含完整的结构化信息
   - **CSV格式**：适合Excel打开，表格形式展示
   - **XML格式**：标准的结构化标记语言格式
   - **TXT格式**：简单易读的文本列表格式

## 文件结构

```
easyRGB/
├── image_color_picker.py  # 主程序文件
├── README.md             # 说明文档
└── requirements.txt      # 依赖列表
```

## 技术说明

- **GUI框架**: tkinter
- **图像处理**: PIL/Pillow
- **颜色转换**: colorsys模块
- **支持格式**: 主要针对BMP文件，也支持其他PIL支持的格式

## 导出数据格式说明

### JSON格式示例
```json
{
  "export_info": {
    "timestamp": "2025-09-01 14:30:25",
    "total_records": 3,
    "tool_version": "1.0",
    "format": "JSON"
  },
  "color_records": [
    {
      "timestamp": "2025-09-01 14:28:15",
      "sequence": 1,
      "position": {"x": 150, "y": 200},
      "rgb": {"r": 255, "g": 128, "b": 64},
      "hsv": {"h": 20, "s": 75, "v": 100},
      "hex": "#FF8040",
      "image_file": "sample.bmp"
    }
  ]
}
```

### CSV格式
包含表头的表格格式，可直接在Excel中打开，包含所有颜色信息的列。

### XML格式
标准的XML结构，适合与其他系统进行数据交换。

### TXT格式
人类可读的文本格式，适合查看和打印。

## 特殊功能

1. **分辨率检查**: 程序会检查图像是否为推荐的1280x1024分辨率
2. **格式验证**: 优先支持BMP格式文件
3. **缩放保持**: 缩放时保持像素完整性
4. **精确取色**: 点击时获取原始图像的精确像素值
5. **历史记录**: 自动记录所有颜色提取历史，支持时间戳和序号
6. **批量导出**: 一次性导出所有记录的颜色数据
7. **DPI自适应**: 在高分辨率显示器上自动调整界面大小
8. **智能重采样**: 根据缩放级别选择最佳图像处理算法

## 开发者信息

这是一个简单而实用的图像取色工具，适合需要精确颜色信息的设计和开发工作。

## 🔥 悬浮窗模式使用指南

### 启动悬浮窗
1. 在主界面点击"启动悬浮窗"按钮
2. 主窗口会隐藏，悬浮窗出现在屏幕右上角
3. 悬浮窗会保持置顶，不会被其他窗口遮挡

### 实时取色
- 移动鼠标到任意位置，悬浮窗会实时显示：
  - 鼠标坐标 (X, Y)
  - RGB颜色值
  - 十六进制颜色值
  - 颜色预览块

### 记录颜色
- **方法1**: 点击悬浮窗中的"取色"按钮
- **方法2**: 使用快捷键 Ctrl+鼠标左键
- 取色成功后会显示通知，颜色自动添加到记录列表

### 退出悬浮窗
- 点击悬浮窗中的"关闭"按钮
- 或点击悬浮窗右上角的X按钮
- 主窗口会重新显示

### 适用场景
- 🎨 从网页设计中提取配色方案
- 💻 从应用程序界面获取UI颜色
- 🖼️ 从图片编辑软件中取色
- 📱 从任何屏幕内容中获取颜色参考

## 开发者信息
